## URL 단축기 설계 시 고려해야 할 사항

- URL 리디렉션
    
    URL 리디렉션의 응답 코드로 301과 302를 사용할 수 있다.
    301의 경우, URL이 영구적으로 이관되었다고 알려주어, 브라우저 내에서 이 응답을 캐시한다. 추후 같은 구 URL로 요청을 보내면 캐시된 내용을 기반으로 자동적으로 신 URL로 요청들 보내게 된다.
    302의 경우는 URL이 일시적으로 이관되었다고 알려주어, 브라우저 내에서 이 응답을 캐시하지 않는다. 이를 통해 항상 서버를 통해 URL 리디렉션이 이루어진다. 이것은 서버에서 트래픽 분석이 중요할 때 사용된다. 
    
- 해시 함수
    
    해시 함수는 원래 URL을 단축 URL로 변환하는 데 사용한다.
    이 때 적절한 hash 값의 길이를 정해야 한다. 이 책에서는 대략적으로 3650억개의 URL를 만들어낼 수 있어야 한다. 
    그를 위해서는 62^n>3650을 만족하는 n의 최소값인 7만큼의 길이가 필요하다.
    이제 이것은 2가지 방법으로 구현이 가능하다.
    
    1. 해시 후 충돌 해소
        
        잘알려진 해시 함수를 사용하여, 해당 해시함수에서 처음 7개의 문자만 사용한다.
        대신 이 때 충돌이 발생하면 사전에 정의한 문자열을 해시값에 덧붙인다.
        문제점은 한번 이상의 데이터베이스 질의를 해야 하므로 오버헤드가 크다.
        
    2. base62변환
        
       해시 값의 사용되는 문자의 개수가 62개이기 때문에 id를 base62 변환을 통해 단축 URL를 표현하게 된다.
       이 방법은 유일성 보장 ID 생성기가 필요하고, ID가 1씩 증가하는 방법이라면 다음에 쓸 수 있는 단축 URL이 무엇인지 쉽게 알아낼 수 있어 보안상 문제가 된다.
       또한 ID값에 따라 단축 URL의 길이가 가변적이다.
